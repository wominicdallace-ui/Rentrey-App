<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             x:Class="Rentrey.AccountPage"
             Title="My Account">

    <ScrollView>

        <VerticalStackLayout Spacing="20" Padding="15">

            <Grid ColumnDefinitions="Auto, *, Auto" Margin="0,15,0,0">

                <Frame Grid.Column="0" 
                       CornerRadius="50" 
                       HeightRequest="60" 
                       WidthRequest="60" 
                       BorderColor="#FFD700"
                       BackgroundColor="#FFF8DC"
                       HorizontalOptions="Center"
                       VerticalOptions="Center">
                    
                    <Image Source="profilepicture.png" 
                           HorizontalOptions="Center" 
                           VerticalOptions="Center"/>
                </Frame>

                <VerticalStackLayout Grid.Column="1"
                                     VerticalOptions="Center"
                                     Spacing="5"
                                     Margin="10,0,0,0">

                    <Label Text="{Binding UserName}"
                           FontSize="18"
                           FontAttributes="Bold"
                           TextColor="#333333"/>
                    <Label Text="{Binding Points}"
                           FontSize="20"
                           FontAttributes="Bold"
                           TextColor="#4CAF50"/>

                    <BoxView HeightRequest="8" 
                             BackgroundColor="#D3D3D3"
                             CornerRadius="4" 
                             HorizontalOptions="FillAndExpand">

                        <BoxView.Background>
                            <LinearGradientBrush StartPoint="0,0" EndPoint="{Binding ProgressRatio, Converter={StaticResource RatioConverter}, FallbackValue='0,0'}">
                                <GradientStop Color="#4CAF50" Offset="{Binding ProgressRatio}" />
                                <GradientStop Color="#D3D3D3" Offset="{Binding ProgressRatio}" />
                            </LinearGradientBrush>
                        </BoxView.Background>
                       
                    </BoxView>
                    <Label Text="{Binding LastUpdated}" FontSize="12" TextColor="#888888"/>
                </VerticalStackLayout>
                       
            </Grid>

            <VerticalStackLayout Margin="0,-10,0,0">

                <Label Text="{Binding RankText}"
                       FontSize="16"
                       FontAttributes="Bold"
                       TextColor="#FF9800"
                       HorizontalOptions="Center"/>
                <Label Text="{Binding PointsAwayText}"
                       FontSize="14"
                       TextColor="#888888"
                       HorizontalOptions="Center" />

            </VerticalStackLayout>

            <Label Text="Recent Points" 
                   FontSize="20" 
                   FontAttributes="Bold" 
                   TextColor="#333333"/>
            
            <CollectionView ItemsSource="{Binding RecentPoints}">
                <CollectionView.ItemTemplate>
                    <DataTemplate>
                        <Frame CornerRadius="10" 
                               Padding="10" 
                               BackgroundColor="White" 
                               Margin="0,5">
                            
                            <Grid ColumnDefinitions="60,*" 
                                  ColumnSpacing="15" 
                                  VerticalOptions="Center">
                                
                                <Label Grid.Column="0" 
                                       Text="{Binding Points, StringFormat='+{0}'}" 
                                       FontSize="20" 
                                       FontAttributes="Bold" 
                                       TextColor="#FFC107" 
                                       HorizontalOptions="Center" 
                                       VerticalOptions="Center"/>
                                
                                <Label Grid.Column="1" 
                                       Text="{Binding Description}" 
                                       FontSize="14" TextColor="#333333" 
                                       VerticalOptions="Center"/>
                                
                            </Grid>
                        </Frame>
                    </DataTemplate>
                </CollectionView.ItemTemplate>
            </CollectionView>

            <Label Text="Earned Badges" 
                   FontSize="20" 
                   FontAttributes="Bold" 
                   TextColor="#333333"/>
            
            <CollectionView ItemsSource="{Binding EarnedBadges}">
                <CollectionView.ItemsLayout>
                    <GridItemsLayout Orientation="Vertical" 
                                     Span="2" 
                                     HorizontalItemSpacing="15" 
                                     VerticalItemSpacing="15" />
                    
                </CollectionView.ItemsLayout>
                <CollectionView.ItemTemplate>
                    <DataTemplate>
                        <Frame CornerRadius="10" 
                               Padding="10" 
                               BackgroundColor="#F9F9F9">
                            
                            <VerticalStackLayout Spacing="5" HorizontalOptions="CenterAndExpand">
                                
                                <Image Source="{Binding IconSource}" 
                                       HeightRequest="50" 
                                       WidthRequest="50" 
                                       HorizontalOptions="Center" />
                                <Label Text="{Binding Title}" 
                                       FontSize="14" 
                                       FontAttributes="Bold" 
                                       TextColor="#333333" 
                                       HorizontalOptions="Center" 
                                       HorizontalTextAlignment="Center"/>
                                <Label Text="{Binding Description}" 
                                       FontSize="12" 
                                       TextColor="#888888" 
                                       HorizontalOptions="Center" 
                                       HorizontalTextAlignment="Center"/>
                                
                            </VerticalStackLayout>
                        </Frame>
                    </DataTemplate>
                </CollectionView.ItemTemplate>
            </CollectionView>
            
        </VerticalStackLayout>
        
    </ScrollView>
    
</ContentPage>
