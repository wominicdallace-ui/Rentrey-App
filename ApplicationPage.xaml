<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             xmlns:local="clr-namespace:Rentrey.Maui"
             x:Class="Rentrey.Maui.ApplicationPage"
             Title="My Applications"
             BackgroundColor="#F5F5F5">

    <ScrollView>
        <VerticalStackLayout Spacing="15" Padding="15">
            <Label Text="My Applications"
                   FontSize="24"
                   FontAttributes="Bold"
                   TextColor="#333333"
                   Margin="0,10,0,0"/>

            <CollectionView ItemsSource="{Binding Applications}"
                            SelectionMode="None">

                <CollectionView.EmptyView>
                    <VerticalStackLayout Spacing="10" VerticalOptions="CenterAndExpand" HorizontalOptions="Center">
                        <Image Source="application_nav.png" HeightRequest="60" Opacity="0.5" />
                        <Label Text="No applications submitted yet."
                               FontSize="16"
                               TextColor="#888888"
                               HorizontalOptions="Center" />
                        <Label Text="Start by viewing a property!"
                               FontSize="14"
                               TextColor="#888888"
                               HorizontalOptions="Center" />
                    </VerticalStackLayout>
                </CollectionView.EmptyView>

                <CollectionView.ItemTemplate>
                    <DataTemplate>
                        <Frame CornerRadius="10"
                               Padding="10"
                               Margin="0,5"
                               BackgroundColor="White">

                            <Grid ColumnDefinitions="*, Auto" ColumnSpacing="10">

                                <VerticalStackLayout Grid.Column="0" Spacing="5">
                                    <Label Text="{Binding PropertyAddress}"
                                           FontSize="18"
                                           FontAttributes="Bold"
                                           TextColor="#333333"/>
                                    <Label Text="{Binding ApplicationDate, StringFormat='Application Date: {0:d}'}"
                                           FontSize="14"
                                           TextColor="#888888"/>
                                    <Label Text="{Binding StatusText}"
                                           FontSize="14"
                                           FontAttributes="Bold"
                                           TextColor="{Binding StatusColor}"/>
                                </VerticalStackLayout>

                                <Button Grid.Column="1"
                                        Text="Delete"
                                        BackgroundColor="#D32F2F"
                                        TextColor="White"
                                        CornerRadius="8"
                                        VerticalOptions="Center"
                                        Padding="10, 5"
                                        FontSize="12"
                                        Command="{Binding Source={RelativeSource AncestorType={x:Type local:ApplicationPage}}, Path=BindingContext.DeleteApplicationCommand}"
                                        CommandParameter="{Binding .}"/>
                            </Grid>
                        </Frame>
                    </DataTemplate>
                </CollectionView.ItemTemplate>
            </CollectionView>
        </VerticalStackLayout>
    </ScrollView>
</ContentPage>